<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="check-circle-fill" fill="currentColor" viewBox="0 0 16 16">
    <path d="M16 8A8 8 0 1 1 0 8a8 8 0 0 1 16 0zm-3.97-3.03a.75.75 0 0 0-1.08.022L7.477 9.417 5.384 7.323a.75.75 0 0 0-1.06 1.06L6.97 11.03a.75.75 0 0 0 1.079-.02l3.992-4.99a.75.75 0 0 0-.01-1.05z"/>
  </symbol>
  <symbol id="exclamation-triangle-fill" fill="currentColor" viewBox="0 0 16 16">
    <path d="M8.982 1.566a1.13 1.13 0 0 0-1.96 0L.165 13.233c-.457.778.091 1.767.98 1.767h13.713c.889 0 1.438-.99.98-1.767L8.982 1.566zM8 5c.535 0 .954.462.9.995l-.35 3.507a.552.552 0 0 1-1.1 0L7.1 5.995A.905.905 0 0 1 8 5zm.002 6a1 1 0 1 1 0 2 1 1 0 0 1 0-2z"/>
  </symbol>
</svg>

<div class="container">
  <div class="row">
    <div class="col-12 d-flex justify-content-between">
      <h1>Pizza Builder</h1>
      <div>
        <button (click)="handleLogout()" class="btn btn-primary btn-sm" type="button">Logout</button>
      </div>
    </div>
  </div>
  <div class="row">
    <div class="col-9"> 
      <div class="pizza-display d-flex justify-content-center mb-3">
        <img src='{{ "assets/" + activeFlavor + ".png" }}' class="img-fluid" alt="mmm pizza">
      </div>
      <form [formGroup]="pizzaForm" (ngSubmit)="onSubmitPizza()">
        <div class="card mb-3">
          <div class="card-header text-center">
            <h2 class="fs-5">Size</h2>
          </div>
          <div class="card-body">
            <div class="btn-group w-100" role="group" aria-label="Crust options">
              <input type="radio" formControlName="Size" value="S" class="btn-check" name="Size" id="small" autocomplete="off">
              <label class="btn btn-outline-primary" for="small">Small</label>
            
              <input type="radio" formControlName="Size" value="M" class="btn-check" name="Size" id="medium" autocomplete="off">
              <label class="btn btn-outline-primary" for="medium">Medium</label>
            
              <input type="radio" formControlName="Size" value="L" class="btn-check" name="Size" id="large" autocomplete="off">
              <label class="btn btn-outline-primary" for="large">Large</label>
            </div>
          </div>
        </div>
        <div class="card mb-3">
          <div class="card-header text-center">
            <h2 class="fs-5">Crust</h2>
          </div>
          <div class="card-body">
            <div class="btn-group w-100" role="group" aria-label="Crust options">
              <input type="radio" formControlName="Crust" value="REGULAR" class="btn-check" name="Crust" id="regular" autocomplete="off">
              <label class="btn btn-outline-primary" for="regular">Regular</label>
            
              <input type="radio" formControlName="Crust" value="THIN" class="btn-check" name="Crust" id="thin" autocomplete="off">
              <label class="btn btn-outline-primary" for="thin">Thin</label>
            
              <input type="radio" formControlName="Crust" value="DEEP" class="btn-check" name="Crust" id="deep" autocomplete="off">
              <label class="btn btn-outline-primary" for="deep">Deep Dish</label>
            </div>
          </div>
        </div>

        <div class="card mb-3">
          <div class="card-header text-center">
            <h2 class="fs-5">Flavor</h2>
          </div>
          <div class="card-body">
            <div class="btn-group w-100" role="group" aria-label="Flavor options">
              <input type="radio" formControlName="Flavor" value="CHEESE" class="btn-check" name="Flavor" id="cheese" autocomplete="off">
              <label class="btn btn-outline-primary" for="cheese">Cheese</label>
            
              <input type="radio" formControlName="Flavor" value="SICILIAN" class="btn-check" name="Flavor" id="sicilian" autocomplete="off">
              <label class="btn btn-outline-primary" for="sicilian">Sicilian</label>
            
              <input type="radio" formControlName="Flavor" value="SUPREME" class="btn-check" name="Flavor" id="supreme" autocomplete="off">
              <label class="btn btn-outline-primary" for="supreme">Supreme</label>

              <input type="radio" formControlName="Flavor" value="PROSCIUTTO" class="btn-check" name="Flavor" id="prosciutto" autocomplete="off">
              <label class="btn btn-outline-primary" for="prosciutto">Prosciutto</label>

              <input type="radio" formControlName="Flavor" value="GARDEN" class="btn-check" name="Flavor" id="garden" autocomplete="off">
              <label class="btn btn-outline-primary" for="garden">Garden</label>

              <input type="radio" formControlName="Flavor" value="VEGGIE" class="btn-check" name="Flavor" id="veggie" autocomplete="off">
              <label class="btn btn-outline-primary" for="veggie">Veggie</label>
            </div>
          </div>
        </div>

        <div class="card mb-3">
          <div class="card-header text-center">
            <h2 class="fs-5">Table Number</h2>
          </div>
          <div class="card-body">
            <div class="btn-group w-100" role="group" aria-label="Flavor options">
              <input type="radio" formControlName="Table_No" value="1" class="btn-check" name="Table_No" id="table_1" autocomplete="off">
              <label class="btn btn-outline-primary" for="table_1">1</label>
            
              <input type="radio" formControlName="Table_No" value="2" class="btn-check" name="Table_No" id="table_2" autocomplete="off">
              <label class="btn btn-outline-primary" for="table_2">2</label>
            
              <input type="radio" formControlName="Table_No" value="3" class="btn-check" name="Table_No" id="table_3" autocomplete="off">
              <label class="btn btn-outline-primary" for="table_3">3</label>

              <input type="radio" formControlName="Table_No" value="4" class="btn-check" name="Table_No" id="table_4" autocomplete="off">
              <label class="btn btn-outline-primary" for="table_4">4</label>

              <input type="radio" formControlName="Table_No" value="5" class="btn-check" name="Table_No" id="table_5" autocomplete="off">
              <label class="btn btn-outline-primary" for="table_5">5</label>

              <input type="radio" formControlName="Table_No" value="6" class="btn-check" name="Table_No" id="table_6" autocomplete="off">
              <label class="btn btn-outline-primary" for="table_6">6</label>

              <input type="radio" formControlName="Table_No" value="7" class="btn-check" name="Table_No" id="table_7" autocomplete="off">
              <label class="btn btn-outline-primary" for="table_7">7</label>
            </div>
          </div>
        </div>
        <div class="alert-container">
          <div *ngIf="submitSuccess" class="alert alert-success d-flex align-items-center" role="alert">
            <svg class="bi flex-shrink-0 me-2" width="24" height="24" role="img" aria-label="Success:"><use xlink:href="#check-circle-fill"/></svg>
            <div>
              Pizza successfully saved.
            </div>
          </div>
        </div>
        <button *ngIf="isSaving" class="btn btn-primary w-100 mb-5" type="button" disabled>
          <span class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span>
          Saving...
        </button>
        <button *ngIf="!isSaving" type="submit" [disabled]="!pizzaForm.valid" class="btn btn-primary w-100 mb-5">Place Order</button>
     </form> 
    </div>
    <div class="col-3">
      <div class="order-list">
        <div *ngFor='let order of orders$ | async' class="order-item">
          <app-order-card [order]="order" (deleteOrderEvent)="deleteOrder($event)"></app-order-card>
        </div>
      </div>
    </div>
  </div>
</div>

<div class="modal" id="myModal" tabindex="-1">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Error</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <div class="alert alert-danger d-flex align-items-center" role="alert">
          <svg class="bi flex-shrink-0 me-2" width="24" height="24" role="img" aria-label="Danger:"><use xlink:href="#exclamation-triangle-fill"/></svg>
          <div *ngIf="errorMsg; else defaultMsg">
            {{ errorMsg }}
          </div>
          <ng-template #defaultMsg>
            There was an unknown error.
          </ng-template>
        </div>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
      </div>
    </div>
  </div>
</div>